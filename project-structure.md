# Project Structure Guide

## Src

Весь исходный код и бизнес логика

### Controller

Папка `controller` хранит в себе "контроллеры", в которых лежат эндпоинты.
Это, грубо говоря, входные точки в наш API

### Datastep

Здесь хранятся все функции для работы с LLM.
Так как мы пока используем только чейны и промпты для них,
то активно используется только папка `datastep/chains`

### Infra

В ней хранятся всякие конфигурационные файлы/переменные и т.д.
Также, в тут лежит подгрузка `.env` файла.

### Middleware

Здесь пока что лежат пару декораторов для мидлвейра (для пред и пост обработки запросов)

### Migrations

Папка, которая отвечает за миграции.
В `env.py` прописываются импорты до схем таблиц.
В `versions` хранятся версии - скрипты миграций, которые накатывают изменения в БД.

### Model

В нашем кейсе `model` содержит основную бизнес логику.
Грубо говоря, здесь лежит полный функционал для всех ручек.
Именно здесь можно делать обработку ошибок, преобразование данных и т.д. по архитектуре

### Repository

В ней содержатся функции для работы с БД.

### Scheme

Здесь хранится типизация для объектов и описание таблиц БД.

## Tests

Скрипты с тестами и доп. функциями для них


# Project Architecture

Основная архитектура проекта:

- Контроллеры/эндпоинты взаимодействуют с моделями
- Модели - это, формально, вся бизнес-логика, они взаимодействуют с репозиториями и прочими сервисами
- Репозитории взаимодействуют с БД
- Схемы описывают все данные, которые мы используем

Пример:
Нам нужно из БД взять какие-то объекты, что-то в них поменять и вернуть в ответе.

Тут нужно сначала заюзать функцию из репозитория, чтобы получить данные из БД.
Потом что-то сделать с ними и вернуть в контроллер,
который потом вернёт эти данные в ответе на запрос.
