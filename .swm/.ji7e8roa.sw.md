---
title: Корневой родитель
---

<SwmSnippet path="/src/model/synchronize_nomenclatures_model.py" line="27">

---

В us.СправочникНоменклатура лежат не только номенклатуры, но и группы.

&nbsp;

Если колонка ЭтоГруппа = 1, то это группа, если ЭтоГруппа = 0, то это номенклатура

&nbsp;

Номенклатуры имеют колонку Родитель. Для номенклатур эта колонка содержит гуид группы, в которую номенклатура входит. Для групп эта колонка содержит гуид родительской группы.

&nbsp;

Получается следующая иерархия:

&nbsp;

Карандаш голубой ← канцелярия из дерева пишущая ← канцелярия из дерева ← канцелярия ← _0001 Новая структура справочника_ ← Загрузка \[у её родителя гуид 00000000-0000-0000-0000-000000000000\]

&nbsp;

Значение _0001 Новая структура справочника_ может быть другим, при этом нас интересует только _0001 Новая структура справочника_.&nbsp;

&nbsp;

В будущем некоторые группы могут перейти из этого дерева в другое, так что нам нужно проверять, не ушла ли группа. Если ушла, то номенклатура в этой группе не интересна и её следует удалить из векторстора.

&nbsp;

Гуид номенклатуры или группы лежит в колонке Ссылка.

&nbsp;

Одно из решений в лоб — подниматься по структуре вверх используя фильтр: Ссылка = ‘<guid группы, который лежит в родителе предыдущей группы или номенклатуры>’

&nbsp;

Группа с гуидом 00000000-0000-0000-0000-000000000000 — это самый верхний уровень в дереве — от него по идеи всё идёт.

&nbsp;

Здесь еще надо описать как работает алгоритм в функции **get_root_group_name**

```python
def get_root_group_name(nom_db_con_str: str, table_name: str, parent):
    current_parent = parent
    root_group = DataFrame()
    while current_parent != "00000000-0000-0000-0000-000000000000":
        st = f"""
            SELECT *
            FROM {table_name}
            WHERE "Ссылка" = '{current_parent}'
        """
        root_group = read_sql(st, nom_db_con_str)
        current_parent = str(root_group['Родитель'].item())

    root_group_name = root_group['Наименование'].item()
    return root_group_name

```

---

</SwmSnippet>

<SwmMeta version="3.0.0" repo-id="Z2l0aHViJTNBJTNBbXN1LWJhY2tlbmQlM0ElM0FibGVzY2h1bm92" repo-name="msu-backend"><sup>Powered by [Swimm](https://app.swimm.io/)</sup></SwmMeta>
